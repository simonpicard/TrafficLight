<?xml version="1.0" encoding="utf-8"?><!DOCTYPE nta PUBLIC '-//Uppaal Team//DTD Flat System 1.1//EN' 'http://www.it.uu.se/research/group/darts/uppaal/flat-1_1.dtd'><nta><declaration>// Place global declarations here.
const int NORTH=0, EAST=1, SOUTH=2, WEST=3;
const int RED=0, ORANGE=1, GREEN=2;
bool pedestrianCrossingButton[4] = {false, false, false, false};
int[0,2] pedestrianLight[4] = {RED, RED, RED, RED};
int[0,2] carLight[4] = {RED, RED, RED, RED};</declaration><template><name x="5" y="5">Pedestrian</name><declaration>int[0,3] location;
clock crossingTime;
int MIN_CROSSING_TIME=3, MAX_CROSSING_TIME=5;</declaration><location id="id0" x="8" y="-112"><name x="32" y="-128">Cross</name><label kind="invariant" x="32" y="-112">crossingTime&lt;=MAX_CROSSING_TIME</label></location><location id="id1" x="-304" y="-112"><name x="-320" y="-144">Wait</name></location><location id="id2" x="-584" y="-112"><name x="-632" y="-152">PushButton</name><committed/></location><location id="id3" x="-976" y="-112"><name x="-992" y="-152">Walk</name></location><init ref="id3"/><transition controllable="false" action=""><source ref="id0"/><target ref="id3"/><label kind="guard" x="-928" y="80">crossingTime&gt;=MIN_CROSSING_TIME</label><nail x="-808" y="72"/></transition><transition action=""><source ref="id2"/><target ref="id0"/><label kind="guard" x="-416" y="-304">pedestrianLight[location] == GREEN</label><label kind="assignment" x="-360" y="-288">crossingTime=0</label><nail x="-296" y="-272"/></transition><transition action=""><source ref="id1"/><target ref="id0"/><label kind="guard" x="-280" y="-144">pedestrianLight[location] == GREEN</label><label kind="assignment" x="-208" y="-128">crossingTime=0</label></transition><transition action=""><source ref="id2"/><target ref="id1"/><label kind="guard" x="-560" y="-104">pedestrianLight[location] == RED</label><label kind="assignment" x="-584" y="-80">pedestrianCrossingButton[location] = true</label></transition><transition controllable="false" action=""><source ref="id3"/><target ref="id2"/><label kind="assignment" x="-848" y="-104">location = SOUTH</label><nail x="-784" y="-80"/></transition><transition controllable="false" action=""><source ref="id3"/><target ref="id2"/><label kind="assignment" x="-840" y="-40">location = WEST</label><nail x="-776" y="-40"/></transition><transition controllable="false" action=""><source ref="id3"/><target ref="id2"/><label kind="assignment" x="-848" y="-144">location = EAST</label><nail x="-784" y="-128"/></transition><transition controllable="false" action=""><source ref="id3"/><target ref="id2"/><label kind="assignment" x="-848" y="-192">location=NORTH</label><nail x="-784" y="-176"/></transition></template><template><name>LightController</name><parameter>chan &amp;toggleRedNorth, chan &amp;toggleGreenNorth, chan &amp;toggleRedEast, chan &amp;toggleGreenEast, chan &amp;toggleRedSouth, chan &amp;toggleGreenSouth, chan &amp;toggleRedWest, chan &amp;toggleGreenWest</parameter><location id="id4" x="-216" y="-24"><name x="-226" y="-54">Initial</name></location><init ref="id4"/><transition action=""><source ref="id4"/><target ref="id4"/><label kind="synchronisation" x="-632" y="-192">toggleRedWest!</label><nail x="-544" y="-128"/><nail x="-480" y="-216"/></transition><transition action=""><source ref="id4"/><target ref="id4"/><label kind="synchronisation" x="-680" y="-32">toggleRedSouth!</label><nail x="-552" y="16"/><nail x="-552" y="-80"/></transition><transition action=""><source ref="id4"/><target ref="id4"/><label kind="synchronisation" x="-632" y="96">toggleRedEast!</label><nail x="-496" y="136"/><nail x="-544" y="32"/></transition><transition action=""><source ref="id4"/><target ref="id4"/><label kind="synchronisation" x="-568" y="192">toggleRedNorth!</label><nail x="-416" y="224"/><nail x="-488" y="160"/></transition><transition action=""><source ref="id4"/><target ref="id4"/><label kind="synchronisation" x="-456" y="264">toggleGreenWest!</label><nail x="-304" y="272"/><nail x="-384" y="224"/></transition><transition action=""><source ref="id4"/><target ref="id4"/><label kind="synchronisation" x="-360" y="312">toggleGreenSouth!</label><nail x="-208" y="312"/><nail x="-288" y="296"/></transition><transition action=""><source ref="id4"/><target ref="id4"/><label kind="synchronisation" x="-152" y="304">toggleGreenEast!</label><nail x="-112" y="296"/><nail x="-184" y="312"/></transition><transition action=""><source ref="id4"/><target ref="id4"/><label kind="synchronisation" x="-56" y="264">toggleGreenNorth!</label><nail x="-24" y="248"/><nail x="-96" y="288"/></transition><transition action=""><source ref="id4"/><target ref="id4"/><label kind="assignment" x="64" y="192">pedestrianLight[WEST]=RED</label><nail x="64" y="160"/><nail x="0" y="224"/></transition><transition action=""><source ref="id4"/><target ref="id4"/><label kind="assignment" x="120" y="72">pedestrianLight[SOUTH]=RED</label><nail x="96" y="48"/><nail x="72" y="112"/></transition><transition action=""><source ref="id4"/><target ref="id4"/><label kind="assignment" x="128" y="-16">pedestrianLight[EAST]=RED</label><nail x="112" y="-40"/><nail x="104" y="32"/></transition><transition action=""><source ref="id4"/><target ref="id4"/><label kind="assignment" x="112" y="-120">pedestrianLight[NORTH]=RED</label><nail x="88" y="-136"/><nail x="96" y="-72"/></transition><transition action=""><source ref="id4"/><target ref="id4"/><label kind="assignment" x="64" y="-208">pedestrianLight[WEST]=GREEN</label><nail x="32" y="-216"/><nail x="72" y="-160"/></transition><transition action=""><source ref="id4"/><target ref="id4"/><label kind="assignment" x="-24" y="-272">pedestrianLight[SOUTH]=GREEN</label><nail x="-64" y="-272"/><nail x="8" y="-216"/></transition><transition action=""><source ref="id4"/><target ref="id4"/><label kind="assignment" x="-120" y="-304">pedestrianLight[EAST]=GREEN</label><nail x="-160" y="-296"/><nail x="-88" y="-272"/></transition><transition action=""><source ref="id4"/><target ref="id4"/><label kind="assignment" x="-344" y="-328">pedestrianLight[NORTH]=GREEN</label><nail x="-248" y="-304"/><nail x="-176" y="-304"/></transition></template><template><name>Light</name><parameter>chan &amp;toggleRed, chan &amp;toggleGreen, int[0,3] location</parameter><declaration>int SWITCHING_TIME = 1;
clock x;</declaration><location id="id5" x="-944" y="56"><name x="-920" y="48">Green</name></location><location id="id6" x="-944" y="-152"><name x="-920" y="-160">Orange</name><label kind="invariant" x="-920" y="-144">x&lt;=SWITCHING_TIME</label></location><location id="id7" x="-944" y="-368"><name x="-920" y="-376">Red</name></location><init ref="id7"/><transition action=""><source ref="id7"/><target ref="id5"/><label kind="synchronisation" x="-1160" y="-160">toggleGreen?</label><label kind="assignment" x="-1248" y="-144">carLight[location]=GREEN</label><nail x="-1056" y="-144"/></transition><transition controllable="false" action=""><source ref="id6"/><target ref="id7"/><label kind="guard" x="-928" y="-272">x==SWITCHING_TIME</label><label kind="assignment" x="-928" y="-256">carLight[location]=RED</label></transition><transition action=""><source ref="id5"/><target ref="id6"/><label kind="synchronisation" x="-936" y="-64">toggleRed?</label><label kind="assignment" x="-936" y="-48">x=0, carLight[location]=ORANGE</label></transition></template><template><name>Car</name><declaration>int[0,3] location;
int[0,3] destination;</declaration><location id="id8" x="-840" y="-160"><name x="-880" y="-192">ApproachLight</name></location><location id="id9" x="-440" y="-160"><name x="-464" y="-192">Cross</name></location><location id="id10" x="-640" y="-160"><name x="-656" y="-192">Wait</name></location><location id="id11" x="-1144" y="-152"><name x="-1216" y="-208">ChooseLocation</name></location><location id="id12" x="-1536" y="-144"><name x="-1592" y="-152">Drive</name></location><init ref="id12"/><transition><source ref="id10"/><target ref="id9"/></transition><transition><source ref="id8"/><target ref="id10"/></transition><transition action=""><source ref="id11"/><target ref="id8"/><label kind="guard" x="-1056" y="-72">location!=WEST</label><label kind="assignment" x="-1064" y="-48">destination=WEST</label><nail x="-984" y="-72"/></transition><transition action=""><source ref="id11"/><target ref="id8"/><label kind="guard" x="-1048" y="-168">location!=SOUTH</label><label kind="assignment" x="-1064" y="-152">destination=SOUTH</label><nail x="-984" y="-112"/></transition><transition action=""><source ref="id11"/><target ref="id8"/><label kind="guard" x="-1048" y="-224">location!=EAST</label><label kind="assignment" x="-1056" y="-208">destination=EAST</label><nail x="-992" y="-192"/></transition><transition action=""><source ref="id11"/><target ref="id8"/><label kind="guard" x="-1064" y="-296">location!=NORTH</label><label kind="assignment" x="-1072" y="-280">destination=NORTH</label><nail x="-992" y="-264"/></transition><transition action=""><source ref="id12"/><target ref="id11"/><label kind="assignment" x="-1400" y="-40">location=WEST</label><nail x="-1336" y="-48"/></transition><transition action=""><source ref="id12"/><target ref="id11"/><label kind="assignment" x="-1400" y="-144">location=SOUTH</label><nail x="-1336" y="-112"/></transition><transition action=""><source ref="id12"/><target ref="id11"/><label kind="assignment" x="-1392" y="-216">location=EAST</label><nail x="-1336" y="-192"/></transition><transition action=""><source ref="id12"/><target ref="id11"/><label kind="assignment" x="-1400" y="-272">location=NORTH</label><nail x="-1336" y="-256"/></transition></template><system>chan toggleRedNorth, toggleGreenNorth;
chan toggleRedEast, toggleGreenEast;
chan toggleRedSouth, toggleGreenSouth;
chan toggleRedWest, toggleGreenWest;

Pedestrian1 = Pedestrian() ;
LightController1 = LightController(toggleRedNorth, toggleGreenNorth, toggleRedEast, toggleGreenEast, toggleRedSouth, toggleGreenSouth, toggleRedWest, toggleGreenWest) ;
LightNorth = Light(toggleRedNorth, toggleGreenNorth, NORTH);
LightEast = Light(toggleRedEast, toggleGreenEast, EAST);
LightSouth = Light(toggleRedSouth, toggleGreenSouth, SOUTH);
LightWest = Light(toggleRedWest, toggleGreenWest, WEST);
system Pedestrian1, LightController1, LightNorth, LightEast, LightSouth, LightWest ;</system></nta>